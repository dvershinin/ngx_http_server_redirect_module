ngx_addon_name=ngx_http_server_redirect_module

if [ $ngx_module_link = DYNAMIC ]; then
    ngx_module_type=HTTP
    ngx_module_name=ngx_http_server_redirect_module
    ngx_module_srcs="$ngx_addon_dir/ngx_http_server_redirect_module.c"
    ngx_module_order="$ngx_module_name \
                      ngx_http_realip_module \
                      ngx_http_write_filter_module"

    . auto/module
else
    HTTP_MODULES="$HTTP_MODULES $ngx_addon_name"
    NGX_ADDON_SRCS="$NGX_ADDON_SRCS $ngx_addon_dir/$ngx_addon_name.c"

    # ngx_module_order doesn't work with static modules,
    # so we must re-order filters here.
    if [ $HTTP_REALIP = YES ]; then
        last=ngx_http_realip_module
    else
        last=ngx_http_write_filter_module
    fi

    HTTP_MODULES=`echo $HTTP_MODULES \
                  | sed "s/$ngx_addon_name//" \
                  | sed "s/$last/$ngx_addon_name $last/"`
fi
